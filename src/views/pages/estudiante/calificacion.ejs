<%- include ../../partials/parte1Superior.ejs %>

<script src="/js/estudianteAsignatura.ajax.js"></script>

</head>

<body>
  <div class="">
    
  </div>
  <!-- ///////////////////////////////////////////////////////7 -->

  <div class="container p-0 my-3">
    <h3>
      Calificaciones
      <a href="asignatura<%= asignatura.idAsignatura%>/informe" class="btn btn-outline-info" data-bs-toggle="popover" data-bs-trigger="hover focus" data-bs-content="Disabled popover">
        <svg xmlns="http://www.w3.org/2000/svg" width="23" height="23" fill="currentColor" class="bi bi-info-circle-fill" viewBox="0 0 16 16">
          <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"/>
        </svg>
      </a>
      
    </h3> 
    <div class="">
      <div>
        <h5> <b><span id="spnCurso"> <%= curso.clave%> </span></b> - 
          <span id="spnAsignatura"> <%= asignatura.asignatura%>, id = <%= asignatura.idAsignatura%></span>
          <p><small><%= estudiantes.length %> estudiantes</small></p>
          <input id="spnIdAsignatura" value="<%= asignatura.idAsignatura%>" hidden>
            
        </h5>
        <hr class="mb-0">
      </div>
      
      <div class="sticky-top mb-3 bg-primary pt-1 pb-1 mt-0">
        <div class="nav nav-pills btn-group col-md-12">
          <a id="periodo1" class="nav-link tabbtn btn btn-primary" href="javascript:void(0)" onclick="openCity(event);" aria-disabled="true">
            <div class="tablink nav-item ">1° Perído</div>
          </a>
          <a id="periodo2" class="nav-link tabbtn btn btn-primary" href="javascript:void(0)" onclick="openCity(event);">
            <div class="tablink nav-item">2° Perído</div>
          </a>
          <a id="periodo3" class="nav-link tabbtn btn btn-primary disabled" href="javascript:void(0)" >
            <div class="tablink nav-item">3° Perído</div>
          </a>
          <a id="periodo4" class="nav-link tabbtn btn btn-primary disabled mr-2" href="javascript:void(0)">
            <div class="tablink nav-item">4° Perído</div>
          </a>
            <button href="#" class="m-2 btn btn-outline-success btn_save mt-0 mb-0" row_id="'+row_id+'">
              <span id="">Guardar</span> 
              <img class="pull-right" id="waitIconAsignatura" src='/img/whiteIconGrisSegmentos.gif' style="display:none ;" width="22" height="22" />
            </button>
        </div>
      </div>

      <table id="estudiantes" class="table table-striped table-bordered table-responsive">
        <thead class="">
          <tr>
            <th>Estudiante</th>
            <th>Valoración (1)</th>
            <th>Informe (1)</th>
            <th>Valoración (2)</th>
            <th>Informe (2)</th>
          </tr>
        </thead>
        <tbody class="tbl_user_data">
          
          <% estudiantes.forEach(function(estudiante){ %>
            
          <tr estudiante_id='<%= estudiante.id %>'>
            <td class="change" style="display:none ;">
              
            </td>
            <td class="estudiante" col_name="nombre">
                <%= estudiante.apellido %>, <%= estudiante.nombre %>
            </td>
           
            
            
            <% calificaciones.forEach(function(calificacion){ %>
              <% if(estudiante.id == calificacion.estudiante && asignatura.idAsignatura == calificacion.asignatura) {%>
                <!-- 1° Informe -->
                
                <td rowNumber = '<%= calificacion._rowNumber %>'>
                  <%= calificacion._rowNumber %>
                  <select class="row_data form-select" edit_type="click" col_name="valoracion1">
                    <option value="" disabled selected></option>
                    <% calificacionCodigos.forEach(function(calificacionCodigo){ 
                      var selected = ( calificacionCodigo.simbolo == calificacion.valoracion1 ) ? "selected" : "";
                    %>
                      <option value="<%=calificacionCodigo.simbolo%>" <%= selected %>>
                        <%=calificacionCodigo.simbolo%> - <%=calificacionCodigo.letra%>
                      </option>
                    <% }); %>
                  </select>
                </td>
                <td>
                  <input  class="row_data form-control" edit_type="click" col_name="informe2" value="<%= calificacion.informe2%>"/>
                </td>
                <!-- 2° Informe -->
                <td>
                  <select class="row_data form-select" edit_type="click" col_name="valoracion1">
                    <option value="" disabled selected></option>
                    <% calificacionCodigos.forEach(function(calificacionCodigo){ 
                      var selected = ( calificacionCodigo.simbolo == calificacion.valoracion2 ) ? "selected" : "";
                    %>
                      <option value="<%=calificacionCodigo.simbolo%>" <%= selected %>>
                        <%=calificacionCodigo.simbolo%> - <%=calificacionCodigo.letra%>
                      </option>
                    <% }); %>
                  </select>
                </td>
                <td>
                  <input  class="row_data form-control" edit_type="click" col_name="informe2" value="<%= calificacion.informe2%>"/>
                </td>
              <% } %>
            <% }) %>
            

          </tr>
          <% }); %>
        </tbody>

      </table>
    </div>

  </div>
  <hr>
 
  <script type="text/javascript">
    // $(document).ready(function() {
    //   document.getElementsByClassName("tabbtn")[0].className += " active";
    //   $('td:nth-child(4),th:nth-child(4)').hide();
    //         $('td:nth-child(5),th:nth-child(5)').hide();
    //     $('#periodo1').click(function() {
    //         //$('td:nth-child(2)').hide();
    //         // if your table has header(th), use this
    //         $('td:nth-child(2),th:nth-child(2)').show();
    //         $('td:nth-child(3),th:nth-child(3)').show();
    //         $('td:nth-child(4),th:nth-child(4)').hide();
    //         $('td:nth-child(5),th:nth-child(5)').hide();
    //     });
    //     $('#periodo2').click(function() {
    //         //$('td:nth-child(2)').hide();
    //         // if your table has header(th), use this
    //         $('td:nth-child(4),th:nth-child(4)').show();
    //         $('td:nth-child(5),th:nth-child(5)').show();
    //         $('td:nth-child(2),th:nth-child(2)').hide();
    //         $('td:nth-child(3),th:nth-child(3)').hide();
    //     });
    // });
</script>

<script>
function openCity(evt, cityName) {
  var i, tablinks;

  tabbtns = document.getElementsByClassName("tabbtn");
  for (i = 0; i < tabbtns.length; i++) {
    tabbtns[i].className = tabbtns[i].className.replace(" active", "");
  }
  evt.currentTarget.className += " active";
  //evt.currentTarget.firstElementChild.className += " text-success";
}
  </script>
<%- include ../../partials/parte2Inferior.ejs %>